<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>MADNESS: madness::SDFParaboloid Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">MADNESS
   &#160;<span id="projectnumber">version 0.9</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacemadness.html">madness</a></li><li class="navelem"><a class="el" href="classmadness_1_1SDFParaboloid.html">SDFParaboloid</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classmadness_1_1SDFParaboloid-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">madness::SDFParaboloid Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A paraboloid (3 dimensions)  
 <a href="classmadness_1_1SDFParaboloid.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="sdf__shape__3D_8h_source.html">sdf_shape_3D.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for madness::SDFParaboloid:</div>
<div class="dyncontent">
<div class="center"><img src="classmadness_1_1SDFParaboloid__inherit__graph.png" border="0" usemap="#madness_1_1SDFParaboloid_inherit__map" alt="Inheritance graph"/></div>
<map name="madness_1_1SDFParaboloid_inherit__map" id="madness_1_1SDFParaboloid_inherit__map">
<area shape="rect" id="node2" href="classmadness_1_1SignedDFInterface.html" title="madness::SignedDFInterface\&lt; 3 \&gt;" alt="" coords="5,5,246,33"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for madness::SDFParaboloid:</div>
<div class="dyncontent">
<div class="center"><img src="classmadness_1_1SDFParaboloid__coll__graph.png" border="0" usemap="#madness_1_1SDFParaboloid_coll__map" alt="Collaboration graph"/></div>
<map name="madness_1_1SDFParaboloid_coll__map" id="madness_1_1SDFParaboloid_coll__map">
<area shape="rect" id="node2" href="classmadness_1_1SignedDFInterface.html" title="madness::SignedDFInterface\&lt; 3 \&gt;" alt="" coords="5,5,246,33"/><area shape="rect" id="node3" href="classmadness_1_1Vector.html" title="A simple, fixed dimension Coordinate. " alt="" coords="271,5,453,33"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8066088a0e13bf5ea2e91eeaa845c859"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1SDFParaboloid.html#a8066088a0e13bf5ea2e91eeaa845c859">SDFParaboloid</a> (const double <a class="el" href="classmadness_1_1SDFParaboloid.html#a65f0f53db545a9db44c3731f4c9dc4a8">c</a>, const <a class="el" href="namespacemadness.html#ad9909f0a2c2a6ff38bb94a2e39c92660">coord_3d</a> &amp;<a class="el" href="classmadness_1_1SDFParaboloid.html#a8592d9c652196a53ae993356e511aa5d">apex</a>, const <a class="el" href="namespacemadness.html#ad9909f0a2c2a6ff38bb94a2e39c92660">coord_3d</a> &amp;direc)</td></tr>
<tr class="memdesc:a8066088a0e13bf5ea2e91eeaa845c859"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor for paraboloid.  <a href="#a8066088a0e13bf5ea2e91eeaa845c859">More...</a><br /></td></tr>
<tr class="separator:a8066088a0e13bf5ea2e91eeaa845c859"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57a86a548e886e4d8a267203d662ceff"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1SDFParaboloid.html#a57a86a548e886e4d8a267203d662ceff">sdf</a> (const <a class="el" href="namespacemadness.html#ad9909f0a2c2a6ff38bb94a2e39c92660">coord_3d</a> &amp;pt) const </td></tr>
<tr class="memdesc:a57a86a548e886e4d8a267203d662ceff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the normal distance.  <a href="#a57a86a548e886e4d8a267203d662ceff">More...</a><br /></td></tr>
<tr class="separator:a57a86a548e886e4d8a267203d662ceff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04123c703eaa8b7ba69759701036aaed"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemadness.html#ad9909f0a2c2a6ff38bb94a2e39c92660">coord_3d</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1SDFParaboloid.html#a04123c703eaa8b7ba69759701036aaed">grad_sdf</a> (const <a class="el" href="namespacemadness.html#ad9909f0a2c2a6ff38bb94a2e39c92660">coord_3d</a> &amp;pt) const </td></tr>
<tr class="memdesc:a04123c703eaa8b7ba69759701036aaed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the gradient of the SDF.  <a href="#a04123c703eaa8b7ba69759701036aaed">More...</a><br /></td></tr>
<tr class="separator:a04123c703eaa8b7ba69759701036aaed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classmadness_1_1SignedDFInterface"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classmadness_1_1SignedDFInterface')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classmadness_1_1SignedDFInterface.html">madness::SignedDFInterface&lt; 3 &gt;</a></td></tr>
<tr class="memitem:a755ecf2955d15d76360ad57a49846996 inherit pub_methods_classmadness_1_1SignedDFInterface"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1SignedDFInterface.html#a755ecf2955d15d76360ad57a49846996">sdf</a> (const <a class="el" href="classmadness_1_1Vector.html">Vector</a>&lt; double, <a class="el" href="wavef_8h.html#ac92befc9e919a4caa991cbddc2455f6a">NDIM</a> &gt; &amp;x) const =0</td></tr>
<tr class="memdesc:a755ecf2955d15d76360ad57a49846996 inherit pub_methods_classmadness_1_1SignedDFInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the signed distance from the surface,.  <a href="#a755ecf2955d15d76360ad57a49846996">More...</a><br /></td></tr>
<tr class="separator:a755ecf2955d15d76360ad57a49846996 inherit pub_methods_classmadness_1_1SignedDFInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeeaa5d7c4daa73f138c5a5a754bceacb inherit pub_methods_classmadness_1_1SignedDFInterface"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmadness_1_1Vector.html">Vector</a>&lt; double, <a class="el" href="wavef_8h.html#ac92befc9e919a4caa991cbddc2455f6a">NDIM</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1SignedDFInterface.html#aeeaa5d7c4daa73f138c5a5a754bceacb">grad_sdf</a> (const <a class="el" href="classmadness_1_1Vector.html">Vector</a>&lt; double, <a class="el" href="wavef_8h.html#ac92befc9e919a4caa991cbddc2455f6a">NDIM</a> &gt; &amp;x) const =0</td></tr>
<tr class="memdesc:aeeaa5d7c4daa73f138c5a5a754bceacb inherit pub_methods_classmadness_1_1SignedDFInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the gradient of the signed distance from the surface (i.e., <code>dsdf(x)/dx</code>[i] )  <a href="#aeeaa5d7c4daa73f138c5a5a754bceacb">More...</a><br /></td></tr>
<tr class="separator:aeeaa5d7c4daa73f138c5a5a754bceacb inherit pub_methods_classmadness_1_1SignedDFInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5c2fb122aba55f3bd5a622f2c24c1a0 inherit pub_methods_classmadness_1_1SignedDFInterface"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1SignedDFInterface.html#ac5c2fb122aba55f3bd5a622f2c24c1a0">~SignedDFInterface</a> ()</td></tr>
<tr class="separator:ac5c2fb122aba55f3bd5a622f2c24c1a0 inherit pub_methods_classmadness_1_1SignedDFInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:af728ebc85e868c159c472b3548186b4b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; long double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1SDFParaboloid.html#af728ebc85e868c159c472b3548186b4b">get_roots</a> (const long double <a class="el" href="classmadness_1_1SDFParaboloid.html#a65f0f53db545a9db44c3731f4c9dc4a8">c</a>, const long double d, const long double z) const </td></tr>
<tr class="memdesc:af728ebc85e868c159c472b3548186b4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds real <a class="el" href="structroot.html" title="POD holding excitation energy and response vector for a single excitation. ">root(s)</a> of the cubic polynomial in the sdf function.  <a href="#af728ebc85e868c159c472b3548186b4b">More...</a><br /></td></tr>
<tr class="separator:af728ebc85e868c159c472b3548186b4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d8006731c1d1569da646f764e72e51a"><td class="memItemLeft" align="right" valign="top">long double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1SDFParaboloid.html#a5d8006731c1d1569da646f764e72e51a">find_root</a> (long double lower, long double upper, const long double <a class="el" href="classmadness_1_1SDFParaboloid.html#a65f0f53db545a9db44c3731f4c9dc4a8">c</a>, const long double d, const long double z, bool <a class="el" href="classmadness_1_1SDFParaboloid.html#ad59ce85928fc241aa794e2ed3c7968a6">dir</a>) const </td></tr>
<tr class="separator:a5d8006731c1d1569da646f764e72e51a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa50f84b1504b6e83f3816d46c27592e9"><td class="memItemLeft" align="right" valign="top">long double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1SDFParaboloid.html#aa50f84b1504b6e83f3816d46c27592e9">eval_cubic</a> (const long double x, const long double <a class="el" href="classmadness_1_1SDFParaboloid.html#a65f0f53db545a9db44c3731f4c9dc4a8">c</a>, const long double d, const long double z) const </td></tr>
<tr class="memdesc:aa50f84b1504b6e83f3816d46c27592e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluates the cubic equation for the Lagrangian multipliers.  <a href="#aa50f84b1504b6e83f3816d46c27592e9">More...</a><br /></td></tr>
<tr class="separator:aa50f84b1504b6e83f3816d46c27592e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae02b0f0d0cbf48c2eda762b1d8f5e7bb"><td class="memItemLeft" align="right" valign="top">long double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1SDFParaboloid.html#ae02b0f0d0cbf48c2eda762b1d8f5e7bb">eval_cubic_deriv</a> (const long double x, const long double <a class="el" href="classmadness_1_1SDFParaboloid.html#a65f0f53db545a9db44c3731f4c9dc4a8">c</a>, const long double d, const long double z) const </td></tr>
<tr class="memdesc:ae02b0f0d0cbf48c2eda762b1d8f5e7bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluates the derivative of the cubic equation for the Lagrangian multipliers.  <a href="#ae02b0f0d0cbf48c2eda762b1d8f5e7bb">More...</a><br /></td></tr>
<tr class="separator:ae02b0f0d0cbf48c2eda762b1d8f5e7bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a8592d9c652196a53ae993356e511aa5d"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="namespacemadness.html#ad9909f0a2c2a6ff38bb94a2e39c92660">coord_3d</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1SDFParaboloid.html#a8592d9c652196a53ae993356e511aa5d">apex</a></td></tr>
<tr class="memdesc:a8592d9c652196a53ae993356e511aa5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The apex.  <a href="#a8592d9c652196a53ae993356e511aa5d">More...</a><br /></td></tr>
<tr class="separator:a8592d9c652196a53ae993356e511aa5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65f0f53db545a9db44c3731f4c9dc4a8"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1SDFParaboloid.html#a65f0f53db545a9db44c3731f4c9dc4a8">c</a></td></tr>
<tr class="memdesc:a65f0f53db545a9db44c3731f4c9dc4a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Curvature/radius of the surface.  <a href="#a65f0f53db545a9db44c3731f4c9dc4a8">More...</a><br /></td></tr>
<tr class="separator:a65f0f53db545a9db44c3731f4c9dc4a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad59ce85928fc241aa794e2ed3c7968a6"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="namespacemadness.html#ad9909f0a2c2a6ff38bb94a2e39c92660">coord_3d</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1SDFParaboloid.html#ad59ce85928fc241aa794e2ed3c7968a6">dir</a></td></tr>
<tr class="memdesc:ad59ce85928fc241aa794e2ed3c7968a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">The direction of the axis, from the apex INSIDE.  <a href="#ad59ce85928fc241aa794e2ed3c7968a6">More...</a><br /></td></tr>
<tr class="separator:ad59ce85928fc241aa794e2ed3c7968a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8db95caed5f116ddd551f22e4416988"><td class="memItemLeft" align="right" valign="top">const long double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1SDFParaboloid.html#ac8db95caed5f116ddd551f22e4416988">zero</a></td></tr>
<tr class="memdesc:ac8db95caed5f116ddd551f22e4416988"><td class="mdescLeft">&#160;</td><td class="mdescRight">Numerical zero for root-finding in sdf.  <a href="#ac8db95caed5f116ddd551f22e4416988">More...</a><br /></td></tr>
<tr class="separator:ac8db95caed5f116ddd551f22e4416988"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e749d80a7d815584698e4d6b6943f41"><td class="memItemLeft" align="right" valign="top">const long double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1SDFParaboloid.html#a6e749d80a7d815584698e4d6b6943f41">rootzero</a></td></tr>
<tr class="memdesc:a6e749d80a7d815584698e4d6b6943f41"><td class="mdescLeft">&#160;</td><td class="mdescRight">Numerical zero for the roots.  <a href="#a6e749d80a7d815584698e4d6b6943f41">More...</a><br /></td></tr>
<tr class="separator:a6e749d80a7d815584698e4d6b6943f41"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A paraboloid (3 dimensions) </p>
<p>The surface is defined by</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ x^2 + y^2 - c * z == 0 \]" src="form_230.png"/>
</p>
<p>where <img class="formulaInl" alt="$ z $" src="form_229.png"/> is along the paraboloid's axis. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a8066088a0e13bf5ea2e91eeaa845c859"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">madness::SDFParaboloid::SDFParaboloid </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacemadness.html#ad9909f0a2c2a6ff38bb94a2e39c92660">coord_3d</a> &amp;&#160;</td>
          <td class="paramname"><em>apex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacemadness.html#ad9909f0a2c2a6ff38bb94a2e39c92660">coord_3d</a> &amp;&#160;</td>
          <td class="paramname"><em>direc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor for paraboloid. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>Parameter <img class="formulaInl" alt="$ c $" src="form_174.png"/> in the definition of the paraboloid </td></tr>
    <tr><td class="paramname">apex</td><td>Apex of paraboloid </td></tr>
    <tr><td class="paramname">direc</td><td>Oriented axis of the paraboloid </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="3dharmonic_8cc.html#a047809198cbf2ebfd058ed4c3da89e47">L</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="aa50f84b1504b6e83f3816d46c27592e9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">long double madness::SDFParaboloid::eval_cubic </td>
          <td>(</td>
          <td class="paramtype">const long double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long double&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long double&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long double&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evaluates the cubic equation for the Lagrangian multipliers. </p>
<p>Cubic equation of interest: d + c(2z+c/2)*L - c(c+z)L^2 + c^2/2L^3 == 0</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Value at which to evaluate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Parameter c for the paraboloid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>The d parameter: x^2+y^2-cz = d </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>The distance from the apex along the paraboloid's axis (called dotp in sdf) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the value </dd></dl>

<p>References <a class="el" href="3dharmonic_8cc.html#a047809198cbf2ebfd058ed4c3da89e47">L</a>.</p>

<p>Referenced by <a class="el" href="classmadness_1_1SDFParaboloid.html#a5d8006731c1d1569da646f764e72e51a">find_root()</a>, and <a class="el" href="classmadness_1_1SDFParaboloid.html#af728ebc85e868c159c472b3548186b4b">get_roots()</a>.</p>

</div>
</div>
<a class="anchor" id="ae02b0f0d0cbf48c2eda762b1d8f5e7bb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">long double madness::SDFParaboloid::eval_cubic_deriv </td>
          <td>(</td>
          <td class="paramtype">const long double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long double&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long double&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long double&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evaluates the derivative of the cubic equation for the Lagrangian multipliers. </p>
<p>Cubic equation of interest: d + c(2z+c/2)*L - c(c+z)L^2 + c^2/2L^3 == 0</p>
<p><a class="el" href="classmadness_1_1Derivative.html" title="Implements derivatives operators with variety of boundary conditions on simulation domain...">Derivative</a>: c(2z+c/2) - 2c(c+z)L + 3c^2/2 L^2</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Value at which to evaluate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Parameter c for the paraboloid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>The d parameter: x^2+y^2-cz = d </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>The distance from the apex along the paraboloid's axis (called dotp in sdf) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the value </dd></dl>

<p>References <a class="el" href="classmadness_1_1SDFParaboloid.html#a65f0f53db545a9db44c3731f4c9dc4a8">c</a>.</p>

</div>
</div>
<a class="anchor" id="a5d8006731c1d1569da646f764e72e51a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">long double madness::SDFParaboloid::find_root </td>
          <td>(</td>
          <td class="paramtype">long double&#160;</td>
          <td class="paramname"><em>lower</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long double&#160;</td>
          <td class="paramname"><em>upper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long double&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long double&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Finds a root in the specified range for the cubic equation.</p>
<p>This uses a simple bisection method... perhaps someone will improve it one day...</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lower</td><td>The bottom of the range </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">upper</td><td>The top of the range </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Parameter c for the paraboloid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>The d parameter: x^2+y^2-cz = d </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>The distance from the apex along the paraboloid's axis (called dotp in sdf) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dir</td><td>True if the function is increasing in the domain, false for decreasing </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the root. </dd></dl>

<p>References <a class="el" href="classmadness_1_1SDFParaboloid.html#aa50f84b1504b6e83f3816d46c27592e9">eval_cubic()</a>, <a class="el" href="namespacempfr.html#a1640c2149685c19caf93a32ae1c646fb">mpfr::fabs()</a>, and <a class="el" href="3dharmonic_8cc.html#a047809198cbf2ebfd058ed4c3da89e47">L</a>.</p>

<p>Referenced by <a class="el" href="classmadness_1_1SDFParaboloid.html#af728ebc85e868c159c472b3548186b4b">get_roots()</a>.</p>

</div>
</div>
<a class="anchor" id="af728ebc85e868c159c472b3548186b4b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;long double&gt; madness::SDFParaboloid::get_roots </td>
          <td>(</td>
          <td class="paramtype">const long double&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long double&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long double&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Finds real <a class="el" href="structroot.html" title="POD holding excitation energy and response vector for a single excitation. ">root(s)</a> of the cubic polynomial in the sdf function. </p>
<p>The cubic equation can successfully solve the cubic analytically, but evaluating the expression can be numerically irksome. Analytical results show that at most one root appears in each of the domains</p><ul>
<li>(-Infinity, (2z+2c-|c-2z|)/(3c))</li>
<li>((2z+2c-|c-2z|)/(3c), (2z+2c+|c-2z|)/(3c))</li>
<li>((2z+2c-|c-2z|)/(3c), Infinity).</li>
</ul>
<p>Furthermore, the cubic is always increasing in the first and third domains, and always decreasing in the second.</p>
<p>Since the cubic is easy to evaluate, we use simple bisections to find the roots... this can probably be improved.</p>
<p>Cubic equation of interest: d + c(2z+c/2)*L - c(c+z)L^2 + c^2/2L^3 == 0</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Parameter c for the paraboloid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>The d parameter: x^2+y^2-cz = d </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>The distance from the apex along the paraboloid's axis (called dotp in sdf) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The <a class="el" href="structroot.html" title="POD holding excitation energy and response vector for a single excitation. ">root(s)</a> </dd></dl>

<p>References <a class="el" href="classmadness_1_1SDFParaboloid.html#aa50f84b1504b6e83f3816d46c27592e9">eval_cubic()</a>, <a class="el" href="namespacempfr.html#a1640c2149685c19caf93a32ae1c646fb">mpfr::fabs()</a>, <a class="el" href="classmadness_1_1SDFParaboloid.html#a5d8006731c1d1569da646f764e72e51a">find_root()</a>, and <a class="el" href="3dharmonic_8cc.html#a047809198cbf2ebfd058ed4c3da89e47">L</a>.</p>

<p>Referenced by <a class="el" href="classmadness_1_1SDFParaboloid.html#a57a86a548e886e4d8a267203d662ceff">sdf()</a>.</p>

</div>
</div>
<a class="anchor" id="a04123c703eaa8b7ba69759701036aaed"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemadness.html#ad9909f0a2c2a6ff38bb94a2e39c92660">coord_3d</a> madness::SDFParaboloid::grad_sdf </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacemadness.html#ad9909f0a2c2a6ff38bb94a2e39c92660">coord_3d</a> &amp;&#160;</td>
          <td class="paramname"><em>pt</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the gradient of the SDF. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pt</td><td>Point at which to compute the gradient </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the gradient </dd></dl>

<p>References <a class="el" href="worldexc_8h.html#a629efc935073cf10318bc5bf759ad8f3">MADNESS_EXCEPTION</a>.</p>

</div>
</div>
<a class="anchor" id="a57a86a548e886e4d8a267203d662ceff"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double madness::SDFParaboloid::sdf </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacemadness.html#ad9909f0a2c2a6ff38bb94a2e39c92660">coord_3d</a> &amp;&#160;</td>
          <td class="paramname"><em>pt</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the normal distance. </p>
<p>This SDF is exact.</p>
<p>Given a point, pt=(x, y, z), the goal is to find another point, pt0=(x0, y0, z0), on the surface that minimizes |pt - pt0|^2. The root of this minimized square distance (and a sign) is the sdf.</p>
<p>For simplicity (here), I will assume that the paraboloid's axis is along the positive z-axis and that the origin is the apex. Note that the code does NOT make these assumptions.</p>
<p>Thus, we want to minimize (x-x0)^2 + (y-y0)^2 + (z-z0)^2 subject to x0^2 + y0^2 - c z0 == 0.</p>
<p>Using Lagrange multipliers, the system of equations is -2(x-x0) == L 2 x0 -2(y-y0) == L 2 y0 -2(z-z0) == L (-c) x0^2 + y0^2 - c z0 == 0.</p>
<p>After some algebra, we get a cubic equation for L, (x^2 + y^2 - c z) + (2c z + c^2/2) L - c (z + c) L^2</p><ul>
<li>c^2/2 L^3 == 0</li>
</ul>
<p>This can be solved analytically in Mathematica, producing a long, messy equation. This equation has some stability issues (large cancellations in some areas) and is not implemented below. Instead we use an iterative root finder to locate the roots of the cubic. The simple bisection method is used, perhaps someone will improve the code someday).</p>
<p>Once we have the correct Lagrange multiplier, |pt - pt0|^2 = c L^2 (z - L c/2 + c/4). The square root of this quantity (with the appropriate sign for inside/outside) gives the sdf.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pt</td><td>Point at which to compute the distance from the surface </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The signed distance from the surface </dd></dl>

<p>References <a class="el" href="classmadness_1_1SDFParaboloid.html#a65f0f53db545a9db44c3731f4c9dc4a8">c</a>, <a class="el" href="namespacempfr.html#a1640c2149685c19caf93a32ae1c646fb">mpfr::fabs()</a>, <a class="el" href="classmadness_1_1SDFParaboloid.html#af728ebc85e868c159c472b3548186b4b">get_roots()</a>, <a class="el" href="3dharmonic_8cc.html#a047809198cbf2ebfd058ed4c3da89e47">L</a>, and <a class="el" href="DFcode_2moldft_8cc.html#a8c9558c8bbbb3f02f973eaf59bd7604a">sqrt()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a8592d9c652196a53ae993356e511aa5d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="namespacemadness.html#ad9909f0a2c2a6ff38bb94a2e39c92660">coord_3d</a> madness::SDFParaboloid::apex</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The apex. </p>

</div>
</div>
<a class="anchor" id="a65f0f53db545a9db44c3731f4c9dc4a8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double madness::SDFParaboloid::c</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Curvature/radius of the surface. </p>

<p>Referenced by <a class="el" href="classmadness_1_1SDFParaboloid.html#ae02b0f0d0cbf48c2eda762b1d8f5e7bb">eval_cubic_deriv()</a>, and <a class="el" href="classmadness_1_1SDFParaboloid.html#a57a86a548e886e4d8a267203d662ceff">sdf()</a>.</p>

</div>
</div>
<a class="anchor" id="ad59ce85928fc241aa794e2ed3c7968a6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="namespacemadness.html#ad9909f0a2c2a6ff38bb94a2e39c92660">coord_3d</a> madness::SDFParaboloid::dir</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The direction of the axis, from the apex INSIDE. </p>

</div>
</div>
<a class="anchor" id="a6e749d80a7d815584698e4d6b6943f41"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const long double madness::SDFParaboloid::rootzero</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Numerical zero for the roots. </p>

</div>
</div>
<a class="anchor" id="ac8db95caed5f116ddd551f22e4416988"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const long double madness::SDFParaboloid::zero</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Numerical zero for root-finding in sdf. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="sdf__shape__3D_8h_source.html">sdf_shape_3D.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Sep 26 2014 10:39:45 for MADNESS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>MADNESS: madness::XCfunctional Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">MADNESS
   &#160;<span id="projectnumber">version 0.9</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacemadness.html">madness</a></li><li class="navelem"><a class="el" href="classmadness_1_1XCfunctional.html">XCfunctional</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-static-methods">Static Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classmadness_1_1XCfunctional-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">madness::XCfunctional Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Simplified interface to XC functionals.  
 <a href="classmadness_1_1XCfunctional.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="chem_2xcfunctional_8h_source.html">xcfunctional.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8c01d3804491de80b2980b69bfaa0593"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a8c01d3804491de80b2980b69bfaa0593">XCfunctional</a> ()</td></tr>
<tr class="memdesc:a8c01d3804491de80b2980b69bfaa0593"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor is required.  <a href="#a8c01d3804491de80b2980b69bfaa0593">More...</a><br /></td></tr>
<tr class="separator:a8c01d3804491de80b2980b69bfaa0593"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae07aaf1fc7fd47e55a94893d1d4a0357"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#ae07aaf1fc7fd47e55a94893d1d4a0357">initialize</a> (const std::string &amp;input_line, bool polarized)</td></tr>
<tr class="memdesc:ae07aaf1fc7fd47e55a94893d1d4a0357"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the object from the user input data.  <a href="#ae07aaf1fc7fd47e55a94893d1d4a0357">More...</a><br /></td></tr>
<tr class="separator:ae07aaf1fc7fd47e55a94893d1d4a0357"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85bb52f4285c16bf5a7c2b8461ccd4c6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a85bb52f4285c16bf5a7c2b8461ccd4c6">~XCfunctional</a> ()</td></tr>
<tr class="memdesc:a85bb52f4285c16bf5a7c2b8461ccd4c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#a85bb52f4285c16bf5a7c2b8461ccd4c6">More...</a><br /></td></tr>
<tr class="separator:a85bb52f4285c16bf5a7c2b8461ccd4c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c2d6c58b30dee5ba0288fe8c10317c9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a5c2d6c58b30dee5ba0288fe8c10317c9">is_lda</a> () const </td></tr>
<tr class="memdesc:a5c2d6c58b30dee5ba0288fe8c10317c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the potential is lda.  <a href="#a5c2d6c58b30dee5ba0288fe8c10317c9">More...</a><br /></td></tr>
<tr class="separator:a5c2d6c58b30dee5ba0288fe8c10317c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6eb00e4e0044d240516b3b9845e948e1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a6eb00e4e0044d240516b3b9845e948e1">is_gga</a> () const </td></tr>
<tr class="memdesc:a6eb00e4e0044d240516b3b9845e948e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the potential is gga (needs first derivatives)  <a href="#a6eb00e4e0044d240516b3b9845e948e1">More...</a><br /></td></tr>
<tr class="separator:a6eb00e4e0044d240516b3b9845e948e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a494933596a2ded5847de5775271349ef"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a494933596a2ded5847de5775271349ef">is_meta</a> () const </td></tr>
<tr class="memdesc:a494933596a2ded5847de5775271349ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the potential is meta gga (needs second derivatives ... not yet supported)  <a href="#a494933596a2ded5847de5775271349ef">More...</a><br /></td></tr>
<tr class="separator:a494933596a2ded5847de5775271349ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a527fdb49aa0e834d98805272a1dbb56a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a527fdb49aa0e834d98805272a1dbb56a">is_dft</a> () const </td></tr>
<tr class="memdesc:a527fdb49aa0e834d98805272a1dbb56a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if there is a <a class="el" href="classmadness_1_1DFT.html">DFT</a> functional (false probably means Hatree-Fock exchange only)  <a href="#a527fdb49aa0e834d98805272a1dbb56a">More...</a><br /></td></tr>
<tr class="separator:a527fdb49aa0e834d98805272a1dbb56a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a54f7c1e2ae306d5109a8d8cd11e62b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a3a54f7c1e2ae306d5109a8d8cd11e62b">is_spin_polarized</a> () const </td></tr>
<tr class="memdesc:a3a54f7c1e2ae306d5109a8d8cd11e62b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the functional is spin_polarized.  <a href="#a3a54f7c1e2ae306d5109a8d8cd11e62b">More...</a><br /></td></tr>
<tr class="separator:a3a54f7c1e2ae306d5109a8d8cd11e62b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ac8ec2438214eee370c2488374d8c7f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a2ac8ec2438214eee370c2488374d8c7f">has_fxc</a> () const </td></tr>
<tr class="memdesc:a2ac8ec2438214eee370c2488374d8c7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the second derivative of the functional is available (not yet supported)  <a href="#a2ac8ec2438214eee370c2488374d8c7f">More...</a><br /></td></tr>
<tr class="separator:a2ac8ec2438214eee370c2488374d8c7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4dcf08f9994ded03d827f58da0ecab5"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#aa4dcf08f9994ded03d827f58da0ecab5">has_kxc</a> () const </td></tr>
<tr class="memdesc:aa4dcf08f9994ded03d827f58da0ecab5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the third derivative of the functional is available (not yet supported)  <a href="#aa4dcf08f9994ded03d827f58da0ecab5">More...</a><br /></td></tr>
<tr class="separator:aa4dcf08f9994ded03d827f58da0ecab5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abde3cc0c5e2f1c6716fea11998bb5c67"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#abde3cc0c5e2f1c6716fea11998bb5c67">hf_exchange_coefficient</a> () const </td></tr>
<tr class="memdesc:abde3cc0c5e2f1c6716fea11998bb5c67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the value of the hf exact exchange coefficient.  <a href="#abde3cc0c5e2f1c6716fea11998bb5c67">More...</a><br /></td></tr>
<tr class="separator:abde3cc0c5e2f1c6716fea11998bb5c67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae99f921e75073a7837d0aaa7f590af35"><td class="memItemLeft" align="right" valign="top">madness::Tensor&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#ae99f921e75073a7837d0aaa7f590af35">exc</a> (const std::vector&lt; madness::Tensor&lt; double &gt; &gt; &amp;t, const int ispin) const </td></tr>
<tr class="memdesc:ae99f921e75073a7837d0aaa7f590af35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the energy functional at given points.  <a href="#ae99f921e75073a7837d0aaa7f590af35">More...</a><br /></td></tr>
<tr class="separator:ae99f921e75073a7837d0aaa7f590af35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92c4babf68d0debf9fb811779ce1b82d"><td class="memItemLeft" align="right" valign="top">madness::Tensor&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a92c4babf68d0debf9fb811779ce1b82d">vxc</a> (const std::vector&lt; madness::Tensor&lt; double &gt; &gt; &amp;t, const int ispin, const int what) const </td></tr>
<tr class="memdesc:a92c4babf68d0debf9fb811779ce1b82d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes components of the potential (derivative of the energy functional) at np points.  <a href="#a92c4babf68d0debf9fb811779ce1b82d">More...</a><br /></td></tr>
<tr class="separator:a92c4babf68d0debf9fb811779ce1b82d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecdef0cd5ff6eefdc09f11fb77ee087e"><td class="memItemLeft" align="right" valign="top">madness::Tensor&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#aecdef0cd5ff6eefdc09f11fb77ee087e">fxc</a> (const std::vector&lt; madness::Tensor&lt; double &gt; &gt; &amp;t, const int ispin, const int what) const </td></tr>
<tr class="separator:aecdef0cd5ff6eefdc09f11fb77ee087e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00e3d641bc50dc2f83159f8f9a108327"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a00e3d641bc50dc2f83159f8f9a108327">plot</a> () const </td></tr>
<tr class="memdesc:a00e3d641bc50dc2f83159f8f9a108327"><td class="mdescLeft">&#160;</td><td class="mdescRight">Crude function to plot the energy and potential functionals.  <a href="#a00e3d641bc50dc2f83159f8f9a108327">More...</a><br /></td></tr>
<tr class="separator:a00e3d641bc50dc2f83159f8f9a108327"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a67da1ef9a8e9aa6751502eaff8a48062"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a67da1ef9a8e9aa6751502eaff8a48062">munge</a> (double rho) const </td></tr>
<tr class="separator:a67da1ef9a8e9aa6751502eaff8a48062"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5424885ce7c0045b2db80260247a5560"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a5424885ce7c0045b2db80260247a5560">munge2</a> (double &amp;rho, double &amp;<a class="el" href="svpe_8cc.html#a08d4c0acfdbc81d9f33f389cfe7839ea">sigma</a>) const </td></tr>
<tr class="separator:a5424885ce7c0045b2db80260247a5560"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90a747ca3692f0b720ec7fa0b7e1b61c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a90a747ca3692f0b720ec7fa0b7e1b61c">munge5</a> (double &amp;rhoa, double &amp;rhob, double &amp;saa, double &amp;sab, double &amp;sbb) const </td></tr>
<tr class="separator:a90a747ca3692f0b720ec7fa0b7e1b61c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-static-methods"></a>
Static Protected Member Functions</h2></td></tr>
<tr class="memitem:abb829a268fcba883d5a9704c78d8592e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#abb829a268fcba883d5a9704c78d8592e">polyn</a> (const double x, double &amp;p, double &amp;dpdx)</td></tr>
<tr class="memdesc:abb829a268fcba883d5a9704c78d8592e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Smoothly switches between constant (x&lt;xmin) and linear function (x&gt;xmax)  <a href="#abb829a268fcba883d5a9704c78d8592e">More...</a><br /></td></tr>
<tr class="separator:abb829a268fcba883d5a9704c78d8592e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4eaa033c6958f704eca535a53fbfdf75"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a4eaa033c6958f704eca535a53fbfdf75">munge_old</a> (double rho)</td></tr>
<tr class="separator:a4eaa033c6958f704eca535a53fbfdf75"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ac8aa0c37291c6d5f6dbc14a31719d02c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#ac8aa0c37291c6d5f6dbc14a31719d02c">spin_polarized</a></td></tr>
<tr class="memdesc:ac8aa0c37291c6d5f6dbc14a31719d02c"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if the functional is spin polarized.  <a href="#ac8aa0c37291c6d5f6dbc14a31719d02c">More...</a><br /></td></tr>
<tr class="separator:ac8aa0c37291c6d5f6dbc14a31719d02c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0e0bf6e1d35c6a8cffbb0ce9eb715d6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#aa0e0bf6e1d35c6a8cffbb0ce9eb715d6">hf_coeff</a></td></tr>
<tr class="memdesc:aa0e0bf6e1d35c6a8cffbb0ce9eb715d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Factor multiplying HF exchange (+1.0 gives HF)  <a href="#aa0e0bf6e1d35c6a8cffbb0ce9eb715d6">More...</a><br /></td></tr>
<tr class="separator:aa0e0bf6e1d35c6a8cffbb0ce9eb715d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d60b7037d387bb741e5427fd545cae2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a0d60b7037d387bb741e5427fd545cae2">rhomin</a></td></tr>
<tr class="separator:a0d60b7037d387bb741e5427fd545cae2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb7ebf629700864d2fc5bbdde3bdbd56"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#aeb7ebf629700864d2fc5bbdde3bdbd56">rhotol</a></td></tr>
<tr class="separator:aeb7ebf629700864d2fc5bbdde3bdbd56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98406e464c186c454afc75ccbf296924"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a98406e464c186c454afc75ccbf296924">sigmin</a></td></tr>
<tr class="separator:a98406e464c186c454afc75ccbf296924"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16a09ea0a0e69db386c07baf833a9df8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmadness_1_1XCfunctional.html#a16a09ea0a0e69db386c07baf833a9df8">sigtol</a></td></tr>
<tr class="separator:a16a09ea0a0e69db386c07baf833a9df8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Simplified interface to XC functionals. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a8c01d3804491de80b2980b69bfaa0593"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">XCfunctional::XCfunctional </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Default constructor is required. </p>

</div>
</div>
<a class="anchor" id="a85bb52f4285c16bf5a7c2b8461ccd4c6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">XCfunctional::~XCfunctional </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ae99f921e75073a7837d0aaa7f590af35"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">madness::Tensor&lt; double &gt; XCfunctional::exc </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; madness::Tensor&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ispin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the energy functional at given points. </p>
<p>This uses the convention that the total energy is <img class="formulaInl" alt="$ E[\rho] = \int \epsilon[\rho(x)] dx$" src="form_23.png"/></p>
<p>Any HF exchange contribution must be separately computed.</p>
<p>Items in the vector argument <code>t</code> are interpreted as follows</p><ul>
<li>Spin un-polarized<ul>
<li><code>t</code>[0] = <img class="formulaInl" alt="$ \rho_{\alpha} $" src="form_24.png"/></li>
<li><code>t</code>[1] = <img class="formulaInl" alt="$ \sigma_{\alpha\alpha} = \nabla \rho_{\alpha}.\nabla \rho_{\alpha} $" src="form_25.png"/> (GGA only)</li>
</ul>
</li>
<li>Spin polarized<ul>
<li><code>t</code>[0] = <img class="formulaInl" alt="$ \rho_{\alpha} $" src="form_24.png"/></li>
<li><code>t</code>[1] = <img class="formulaInl" alt="$ \rho_{\beta} $" src="form_26.png"/></li>
<li><code>t</code>[2] = <img class="formulaInl" alt="$ \sigma_{\alpha\alpha} = \nabla \rho_{\alpha}.\nabla \rho_{\alpha} $" src="form_25.png"/> (GGA only)</li>
<li><code>t</code>[3] = <img class="formulaInl" alt="$ \sigma_{\alpha\beta} = \nabla \rho_{\alpha}.\nabla \rho_{\beta} $" src="form_27.png"/> (GGA only)</li>
<li><code>t</code>[4] = <img class="formulaInl" alt="$ \sigma_{\beta\beta} = \nabla \rho_{\beta}.\nabla \rho_{\beta} $" src="form_28.png"/> (GGA only)</li>
</ul>
</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t</td><td>The input densities and derivatives as required by the functional </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The exchange-correlation energy functional </dd></dl>

<p>References <a class="el" href="namespacemadness.html#af54d4defb13f436d68f5dffcfe1899af">madness::c_rks_vwn5__()</a>, <a class="el" href="namespacemadness.html#ab60c0257270dd75fbf805f4b19371dd0">madness::c_uks_vwn5__()</a>, <a class="el" href="namespacemadness.html#ac2a2ea603162b24979ef4b48007b98a8">madness::f</a>, <a class="el" href="3dharmonic_8cc.html#a047809198cbf2ebfd058ed4c3da89e47">L</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a67da1ef9a8e9aa6751502eaff8a48062">munge()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#ac8aa0c37291c6d5f6dbc14a31719d02c">spin_polarized</a>, <a class="el" href="namespacemadness.html#ab80e491600bc86cbf7113901bbb5b63a">madness::x_rks_s__()</a>, and <a class="el" href="namespacemadness.html#a9929afdb3af0f6d0f8fcef20eed027f0">madness::x_uks_s__()</a>.</p>

<p>Referenced by <a class="el" href="structmadness_1_1xc__functional.html#a821171dd68efc338e1a3dc585e5b2dd3">madness::xc_functional::operator()()</a>, and <a class="el" href="classmadness_1_1XCfunctional.html#a00e3d641bc50dc2f83159f8f9a108327">plot()</a>.</p>

</div>
</div>
<a class="anchor" id="aecdef0cd5ff6eefdc09f11fb77ee087e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">madness::Tensor&lt; double &gt; XCfunctional::fxc </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; madness::Tensor&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ispin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>what</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>References <a class="el" href="worldexc_8h.html#a629efc935073cf10318bc5bf759ad8f3">MADNESS_EXCEPTION</a>.</p>

<p>Referenced by <a class="el" href="structmadness_1_1make__fxc.html#a85202f9f399e9a7cf353729bb2c3bde4">madness::make_fxc::operator()()</a>, <a class="el" href="structmadness_1_1get__derivatives.html#a66ab4732dd36d4f9a28fdfecbe59ea7f">madness::get_derivatives::operator()()</a>, <a class="el" href="structmadness_1_1perturbed__vxc.html#aa424088705e5b1303f103c85028a04df">madness::perturbed_vxc::operator()()</a>, <a class="el" href="structmadness_1_1apply__kernel__functor.html#a75ef30b341d2b45a2fe5271f012b092f">madness::apply_kernel_functor::operator()()</a>, and <a class="el" href="structmadness_1_1xc__kernel.html#a7134c3e8d649feb4aa169be3391e9a3b">madness::xc_kernel::operator()()</a>.</p>

</div>
</div>
<a class="anchor" id="a2ac8ec2438214eee370c2488374d8c7f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool XCfunctional::has_fxc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if the second derivative of the functional is available (not yet supported) </p>

</div>
</div>
<a class="anchor" id="aa4dcf08f9994ded03d827f58da0ecab5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool XCfunctional::has_kxc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if the third derivative of the functional is available (not yet supported) </p>

</div>
</div>
<a class="anchor" id="abde3cc0c5e2f1c6716fea11998bb5c67"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double madness::XCfunctional::hf_exchange_coefficient </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the value of the hf exact exchange coefficient. </p>

<p>References <a class="el" href="classmadness_1_1XCfunctional.html#aa0e0bf6e1d35c6a8cffbb0ce9eb715d6">hf_coeff</a>.</p>

<p>Referenced by <a class="el" href="structSCF.html#a2f513c6723e774b846b3cf515563489e">SCF::apply_potential()</a>, and <a class="el" href="classmadness_1_1SCF.html#a3b5fb4140024669840b26a5ff70cf072">madness::SCF::apply_potential()</a>.</p>

</div>
</div>
<a class="anchor" id="ae07aaf1fc7fd47e55a94893d1d4a0357"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void XCfunctional::initialize </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>input_line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>polarized</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the object from the user input data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">input_line</td><td>User input line (without beginning XC keyword) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">polarized</td><td>Boolean flag indicating if the calculation is spin-polarized </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="classmadness_1_1XCfunctional.html#aa0e0bf6e1d35c6a8cffbb0ce9eb715d6">hf_coeff</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a0d60b7037d387bb741e5427fd545cae2">rhomin</a>, <a class="el" href="classmadness_1_1XCfunctional.html#aeb7ebf629700864d2fc5bbdde3bdbd56">rhotol</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a98406e464c186c454afc75ccbf296924">sigmin</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a16a09ea0a0e69db386c07baf833a9df8">sigtol</a>, <a class="el" href="classmadness_1_1XCfunctional.html#ac8aa0c37291c6d5f6dbc14a31719d02c">spin_polarized</a>, and <a class="el" href="namespacemadness.html#afcde52e430e0a853237e4938b27ca771">madness::transform()</a>.</p>

<p>Referenced by <a class="el" href="h2dft_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main()</a>, and <a class="el" href="classmadness_1_1SCF.html#ad0a43483103ac60d286b144f79164e5c">madness::SCF::SCF()</a>.</p>

</div>
</div>
<a class="anchor" id="a527fdb49aa0e834d98805272a1dbb56a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool XCfunctional::is_dft </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if there is a <a class="el" href="classmadness_1_1DFT.html">DFT</a> functional (false probably means Hatree-Fock exchange only) </p>

<p>References <a class="el" href="classmadness_1_1XCfunctional.html#a6eb00e4e0044d240516b3b9845e948e1">is_gga()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a5c2d6c58b30dee5ba0288fe8c10317c9">is_lda()</a>, and <a class="el" href="classmadness_1_1XCfunctional.html#a494933596a2ded5847de5775271349ef">is_meta()</a>.</p>

<p>Referenced by <a class="el" href="structSCF.html#a2f513c6723e774b846b3cf515563489e">SCF::apply_potential()</a>, <a class="el" href="classmadness_1_1SCF.html#a3b5fb4140024669840b26a5ff70cf072">madness::SCF::apply_potential()</a>, and <a class="el" href="classmadness_1_1SCF.html#a7756a90879358b6b62a088c6d49155a9">madness::SCF::solve()</a>.</p>

</div>
</div>
<a class="anchor" id="a6eb00e4e0044d240516b3b9845e948e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool XCfunctional::is_gga </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if the potential is gga (needs first derivatives) </p>

<p>Referenced by <a class="el" href="classmadness_1_1TDA__DFT.html#a6865521082a1cca8fc22d9c7f6d38b1f">madness::TDA_DFT::apply_kernel()</a>, <a class="el" href="structSCF.html#a2f513c6723e774b846b3cf515563489e">SCF::apply_potential()</a>, <a class="el" href="classmadness_1_1SCF.html#a3b5fb4140024669840b26a5ff70cf072">madness::SCF::apply_potential()</a>, <a class="el" href="classWSTFunctional.html#a0306ec063a67e719d1f30c525a0034f8">WSTFunctional::apply_xc()</a>, <a class="el" href="classmadness_1_1TDA__DFT.html#a725b3b924d573c9958987edce0ae8f28">madness::TDA_DFT::convolution_with_kernel()</a>, <a class="el" href="classmadness_1_1TDA__DFT.html#ab91c7a0ae371a1d381466671ac110e38">madness::TDA_DFT::evaluate_derivatives()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a527fdb49aa0e834d98805272a1dbb56a">is_dft()</a>, <a class="el" href="classmadness_1_1TDA__DFT.html#a34772049296eac96be4a4fd428eb95b9">madness::TDA_DFT::is_gga()</a>, <a class="el" href="h2dft_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main()</a>, <a class="el" href="structmadness_1_1perturbed__vxc.html#aa424088705e5b1303f103c85028a04df">madness::perturbed_vxc::operator()()</a>, <a class="el" href="structmadness_1_1apply__kernel__functor.html#a75ef30b341d2b45a2fe5271f012b092f">madness::apply_kernel_functor::operator()()</a>, <a class="el" href="classmadness_1_1SCF.html#a7756a90879358b6b62a088c6d49155a9">madness::SCF::solve()</a>, and <a class="el" href="classmadness_1_1TDA__DFT.html#aabf86b219dd20291293e346f6eb3e996">madness::TDA_DFT::TDA_DFT()</a>.</p>

</div>
</div>
<a class="anchor" id="a5c2d6c58b30dee5ba0288fe8c10317c9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool XCfunctional::is_lda </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if the potential is lda. </p>

<p>References <a class="el" href="classmadness_1_1XCfunctional.html#aa0e0bf6e1d35c6a8cffbb0ce9eb715d6">hf_coeff</a>.</p>

<p>Referenced by <a class="el" href="classmadness_1_1TDA__DFT.html#a725b3b924d573c9958987edce0ae8f28">madness::TDA_DFT::convolution_with_kernel()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a527fdb49aa0e834d98805272a1dbb56a">is_dft()</a>, <a class="el" href="structmadness_1_1perturbed__vxc.html#aa424088705e5b1303f103c85028a04df">madness::perturbed_vxc::operator()()</a>, and <a class="el" href="classmadness_1_1TDA__DFT.html#aabf86b219dd20291293e346f6eb3e996">madness::TDA_DFT::TDA_DFT()</a>.</p>

</div>
</div>
<a class="anchor" id="a494933596a2ded5847de5775271349ef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool XCfunctional::is_meta </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if the potential is meta gga (needs second derivatives ... not yet supported) </p>

<p>Referenced by <a class="el" href="classmadness_1_1XCfunctional.html#a527fdb49aa0e834d98805272a1dbb56a">is_dft()</a>.</p>

</div>
</div>
<a class="anchor" id="a3a54f7c1e2ae306d5109a8d8cd11e62b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool madness::XCfunctional::is_spin_polarized </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns true if the functional is spin_polarized. </p>

<p>References <a class="el" href="classmadness_1_1XCfunctional.html#ac8aa0c37291c6d5f6dbc14a31719d02c">spin_polarized</a>.</p>

<p>Referenced by <a class="el" href="structSCF.html#a2f513c6723e774b846b3cf515563489e">SCF::apply_potential()</a>, <a class="el" href="classmadness_1_1SCF.html#a3b5fb4140024669840b26a5ff70cf072">madness::SCF::apply_potential()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a00e3d641bc50dc2f83159f8f9a108327">plot()</a>, <a class="el" href="classmadness_1_1SCF.html#a7756a90879358b6b62a088c6d49155a9">madness::SCF::solve()</a>, and <a class="el" href="classmadness_1_1TDA__DFT.html#aabf86b219dd20291293e346f6eb3e996">madness::TDA_DFT::TDA_DFT()</a>.</p>

</div>
</div>
<a class="anchor" id="a67da1ef9a8e9aa6751502eaff8a48062"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double madness::XCfunctional::munge </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rho</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>References <a class="el" href="classmadness_1_1XCfunctional.html#a0d60b7037d387bb741e5427fd545cae2">rhomin</a>.</p>

<p>Referenced by <a class="el" href="classmadness_1_1XCfunctional.html#ae99f921e75073a7837d0aaa7f590af35">exc()</a>, and <a class="el" href="classmadness_1_1XCfunctional.html#a92c4babf68d0debf9fb811779ce1b82d">vxc()</a>.</p>

</div>
</div>
<a class="anchor" id="a5424885ce7c0045b2db80260247a5560"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void madness::XCfunctional::munge2 </td>
          <td>(</td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>sigma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>References <a class="el" href="classmadness_1_1XCfunctional.html#a0d60b7037d387bb741e5427fd545cae2">rhomin</a>, and <a class="el" href="classmadness_1_1XCfunctional.html#a98406e464c186c454afc75ccbf296924">sigmin</a>.</p>

</div>
</div>
<a class="anchor" id="a90a747ca3692f0b720ec7fa0b7e1b61c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void madness::XCfunctional::munge5 </td>
          <td>(</td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>rhoa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>rhob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>saa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>sab</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>sbb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>References <a class="el" href="classmadness_1_1XCfunctional.html#a0d60b7037d387bb741e5427fd545cae2">rhomin</a>, and <a class="el" href="classmadness_1_1XCfunctional.html#a98406e464c186c454afc75ccbf296924">sigmin</a>.</p>

</div>
</div>
<a class="anchor" id="a4eaa033c6958f704eca535a53fbfdf75"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double madness::XCfunctional::munge_old </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rho</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>References <a class="el" href="classmadness_1_1XCfunctional.html#abb829a268fcba883d5a9704c78d8592e">polyn()</a>.</p>

</div>
</div>
<a class="anchor" id="a00e3d641bc50dc2f83159f8f9a108327"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void madness::XCfunctional::plot </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Crude function to plot the energy and potential functionals. </p>

<p>References <a class="el" href="classmadness_1_1XCfunctional.html#ae99f921e75073a7837d0aaa7f590af35">exc()</a>, <a class="el" href="namespacemadness.html#ac2a2ea603162b24979ef4b48007b98a8">madness::f</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a3a54f7c1e2ae306d5109a8d8cd11e62b">is_spin_polarized()</a>, and <a class="el" href="classmadness_1_1XCfunctional.html#a92c4babf68d0debf9fb811779ce1b82d">vxc()</a>.</p>

</div>
</div>
<a class="anchor" id="abb829a268fcba883d5a9704c78d8592e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void madness::XCfunctional::polyn </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>dpdx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Smoothly switches between constant (x&lt;xmin) and linear function (x&gt;xmax) </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ f(x,x_{\mathrm{min}},x_{\mathrm{max}}) = \left\{ \begin{array}{ll} x_{\mathrm{min}} &amp; x < x_{\mathrm{min}} p(x,x_{\mathrm{min}},x_{\mathrm{max}}) &amp; x_{\mathrm{min}} \leq x_{\mathrm{max}} x &amp; x_{\mathrm{max}} < x \end{array} \right. \]" src="form_17.png"/>
</p>
<p> where <img class="formulaInl" alt="$p(x)$" src="form_18.png"/> is the unique quintic polynomial that satisfies <img class="formulaInl" alt="$p(x_{min})=x_{min}$" src="form_19.png"/>, <img class="formulaInl" alt="$p(x_{max})=x_{max}$" src="form_20.png"/>, <img class="formulaInl" alt="$dp(x_{max})/dx=1$" src="form_21.png"/>, and <img class="formulaInl" alt="$dp(x_{min})/dx=d^2p(x_{min})/dx^2=d^2p(x_{max})/dx^2=0$" src="form_22.png"/>. </p>

<p>References <a class="el" href="y1_8cc.html#a55807b620385f9c5feb4bb25a651e8df">a()</a>, <a class="el" href="y1_8cc.html#a8edb09333aecbc60d69c0ce58542e31d">b()</a>, and <a class="el" href="gfit_8cc.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>.</p>

<p>Referenced by <a class="el" href="classmadness_1_1XCfunctional.html#a4eaa033c6958f704eca535a53fbfdf75">munge_old()</a>.</p>

</div>
</div>
<a class="anchor" id="a92c4babf68d0debf9fb811779ce1b82d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">madness::Tensor&lt; double &gt; XCfunctional::vxc </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; madness::Tensor&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ispin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>what</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes components of the potential (derivative of the energy functional) at np points. </p>
<p>Any HF exchange contribution must be separately computed.</p>
<p>See the documenation of the <code><a class="el" href="classmadness_1_1XCfunctional.html#ae99f921e75073a7837d0aaa7f590af35" title="Computes the energy functional at given points. ">exc()</a></code> method for contents of the input <code>t</code>[] argument</p>
<p>We define <img class="formulaInl" alt="$ \sigma_{\mu \nu} = \nabla \rho_{\mu} . \nabla \rho_{\nu} $" src="form_29.png"/> with <img class="formulaInl" alt="$ \mu, \nu = \alpha$" src="form_30.png"/> or <img class="formulaInl" alt="$ \beta $" src="form_31.png"/>.</p>
<p>For unpolarized GGA, matrix elements of the potential are <img class="formulaInl" alt="$ < \phi | \hat V | \psi > = \int \left( \frac{\partial \epsilon}{\partial \rho_{\alpha}} \phi \psi + \left( 2 \frac{\partial \epsilon}{\partial \sigma_{\alpha \alpha}} + \frac{\partial \epsilon}{\partial \sigma_{\alpha \beta}} \right) \nabla \rho_{\alpha} . \nabla \left( \phi \psi \right) \right) dx $" src="form_32.png"/></p>
<p>For polarized GGA, matrix elements of the potential are <img class="formulaInl" alt="$ < \phi_{\alpha} | \hat V | \psi_{\alpha} > = \int \left( \frac{\partial \epsilon}{\partial \rho_{\alpha}} \phi \psi + \left( 2 \frac{\partial \epsilon}{\partial \sigma_{\alpha \alpha}} \nabla \rho_{\alpha} + \frac{\partial \epsilon}{\partial \sigma_{\alpha \beta}} \nabla \rho_{\beta} \right) . \nabla \left( \phi \psi \right) \right) dx $" src="form_33.png"/></p>
<p>Integrating the above by parts and assuming free-space or periodic boundary conditions we obtain that the local multiplicative form of the GGA potential is <img class="formulaInl" alt="$ V_{\alpha} = \frac{\partial \epsilon}{\partial \rho_{\alpha}} - \left(\nabla . \left(2 \frac{\partial \epsilon}{\partial \sigma_{\alpha \alpha}} \nabla \rho_{\alpha} + \frac{\partial \epsilon}{\partial \sigma_{\alpha \beta}} \nabla \rho_{\beta} \right) \right) $" src="form_34.png"/></p>
<p>Until we get a <a class="el" href="singletonmadness_1_1Function.html" title="A multiresolution adaptive numerical function. ">madness::Function</a> operation that can produce multiple results we need to compute components of the functional and potential separately:</p>
<ul>
<li>Spin un-polarized<ul>
<li><code>what=0</code> <img class="formulaInl" alt="$ \frac{\partial \epsilon}{\partial \rho_{\alpha}}$" src="form_35.png"/></li>
<li><code>what=1</code> <img class="formulaInl" alt="$ 2 \frac{\partial \epsilon}{\partial \sigma_{\alpha \alpha}} + \frac{\partial \epsilon}{\partial \sigma_{\alpha \beta}}$" src="form_36.png"/> (GGA only)</li>
</ul>
</li>
<li>Spin polarized<ul>
<li><code>what=0</code> <img class="formulaInl" alt="$ \frac{\partial \epsilon}{\partial \rho_{\alpha}}$" src="form_35.png"/></li>
<li><code>what=1</code> <img class="formulaInl" alt="$ \frac{\partial \epsilon}{\partial \rho_{\beta}}$" src="form_37.png"/></li>
<li><code>what=2</code> <img class="formulaInl" alt="$ \frac{\partial \epsilon}{\partial \sigma_{\alpha \alpha}} $" src="form_38.png"/></li>
<li><code>what=3</code> <img class="formulaInl" alt="$ \frac{\partial \epsilon}{\partial \sigma_{\alpha \beta}} $" src="form_39.png"/></li>
<li><code>what=4</code> <img class="formulaInl" alt="$ \frac{\partial \epsilon}{\partial \sigma_{\beta \beta}} $" src="form_40.png"/></li>
</ul>
</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>The input densities and derivatives as required by the functional </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">what</td><td>Specifies which component of the potential is to be computed as described above </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The component specified by the <code>what</code> parameter </dd></dl>

<p>References <a class="el" href="namespacemadness.html#af54d4defb13f436d68f5dffcfe1899af">madness::c_rks_vwn5__()</a>, <a class="el" href="namespacemadness.html#ab60c0257270dd75fbf805f4b19371dd0">madness::c_uks_vwn5__()</a>, <a class="el" href="namespacemadness.html#ac2a2ea603162b24979ef4b48007b98a8">madness::f</a>, <a class="el" href="3dharmonic_8cc.html#a047809198cbf2ebfd058ed4c3da89e47">L</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a67da1ef9a8e9aa6751502eaff8a48062">munge()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#ac8aa0c37291c6d5f6dbc14a31719d02c">spin_polarized</a>, <a class="el" href="namespacemadness.html#ab80e491600bc86cbf7113901bbb5b63a">madness::x_rks_s__()</a>, and <a class="el" href="namespacemadness.html#a9929afdb3af0f6d0f8fcef20eed027f0">madness::x_uks_s__()</a>.</p>

<p>Referenced by <a class="el" href="structmadness_1_1unperturbed__vxc.html#a0077e67b69a0df94546e712f39e85e47">madness::unperturbed_vxc::operator()()</a>, <a class="el" href="structmadness_1_1perturbed__vxc.html#aa424088705e5b1303f103c85028a04df">madness::perturbed_vxc::operator()()</a>, <a class="el" href="structmadness_1_1xc__potential.html#aa64d3453eb4b0ca3d997267bbdf9d934">madness::xc_potential::operator()()</a>, and <a class="el" href="classmadness_1_1XCfunctional.html#a00e3d641bc50dc2f83159f8f9a108327">plot()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="aa0e0bf6e1d35c6a8cffbb0ce9eb715d6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double madness::XCfunctional::hf_coeff</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Factor multiplying HF exchange (+1.0 gives HF) </p>

<p>Referenced by <a class="el" href="classmadness_1_1XCfunctional.html#abde3cc0c5e2f1c6716fea11998bb5c67">hf_exchange_coefficient()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#ae07aaf1fc7fd47e55a94893d1d4a0357">initialize()</a>, and <a class="el" href="classmadness_1_1XCfunctional.html#a5c2d6c58b30dee5ba0288fe8c10317c9">is_lda()</a>.</p>

</div>
</div>
<a class="anchor" id="a0d60b7037d387bb741e5427fd545cae2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double madness::XCfunctional::rhomin</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Referenced by <a class="el" href="classmadness_1_1XCfunctional.html#ae07aaf1fc7fd47e55a94893d1d4a0357">initialize()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a67da1ef9a8e9aa6751502eaff8a48062">munge()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a5424885ce7c0045b2db80260247a5560">munge2()</a>, and <a class="el" href="classmadness_1_1XCfunctional.html#a90a747ca3692f0b720ec7fa0b7e1b61c">munge5()</a>.</p>

</div>
</div>
<a class="anchor" id="aeb7ebf629700864d2fc5bbdde3bdbd56"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double madness::XCfunctional::rhotol</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Referenced by <a class="el" href="classmadness_1_1XCfunctional.html#ae07aaf1fc7fd47e55a94893d1d4a0357">initialize()</a>.</p>

</div>
</div>
<a class="anchor" id="a98406e464c186c454afc75ccbf296924"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double madness::XCfunctional::sigmin</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Referenced by <a class="el" href="classmadness_1_1XCfunctional.html#ae07aaf1fc7fd47e55a94893d1d4a0357">initialize()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a5424885ce7c0045b2db80260247a5560">munge2()</a>, and <a class="el" href="classmadness_1_1XCfunctional.html#a90a747ca3692f0b720ec7fa0b7e1b61c">munge5()</a>.</p>

</div>
</div>
<a class="anchor" id="a16a09ea0a0e69db386c07baf833a9df8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double madness::XCfunctional::sigtol</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Referenced by <a class="el" href="classmadness_1_1XCfunctional.html#ae07aaf1fc7fd47e55a94893d1d4a0357">initialize()</a>.</p>

</div>
</div>
<a class="anchor" id="ac8aa0c37291c6d5f6dbc14a31719d02c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool madness::XCfunctional::spin_polarized</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>True if the functional is spin polarized. </p>

<p>Referenced by <a class="el" href="classmadness_1_1XCfunctional.html#ae99f921e75073a7837d0aaa7f590af35">exc()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#ae07aaf1fc7fd47e55a94893d1d4a0357">initialize()</a>, <a class="el" href="classmadness_1_1XCfunctional.html#a3a54f7c1e2ae306d5109a8d8cd11e62b">is_spin_polarized()</a>, and <a class="el" href="classmadness_1_1XCfunctional.html#a92c4babf68d0debf9fb811779ce1b82d">vxc()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="chem_2xcfunctional_8h_source.html">chem/xcfunctional.h</a></li>
<li><a class="el" href="chem_2xcfunctional__ldaonly_8cc.html">chem/xcfunctional_ldaonly.cc</a></li>
<li><a class="el" href="chem_2xcfunctional__libxc_8cc.html">chem/xcfunctional_libxc.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Sep 26 2014 10:39:48 for MADNESS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
